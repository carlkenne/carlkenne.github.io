<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <style>
      body {
        padding: 30px;
        background: rgb(2, 0, 36);
        background: linear-gradient(
          146deg,
          rgba(2, 0, 36, 1) 0%,
          rgba(193, 205, 255, 1) 0%,
          rgba(247, 243, 204, 1) 100%
        );
      }
      #saved {
        font-size: 70px;
        text-transform: uppercase;
        font-family: arial;
        margin-top: 20px;
      }
      #saved > * {
        cursor: pointer;
      }
      #text {
        font-size: 70px;
        text-transform: uppercase;
        padding: 20px;
        flex-grow: 1;
        width: 100%;
      }
      #speak {
        margin-left: 20px;
        font-size: 40px;
        text-align: center;
        padding: 6px 20px 6px 20px;
        width: 145px;
      }
      #save {
        font-size: 40px;
        text-align: center;
        margin-left: 20px;
        padding: 6px 20px 6px 20px;
        width: 145px;
      }
      .color-box {
        display: inline-block;
        height: 50px;
        width: 50px;
        border: 1px solid white;
        margin: 4px;
      }

      [data-color="red"] {
        background-color: red;
      }
      [data-color="blue"] {
        background-color: blue;
      }
      [data-color="green"] {
        background-color: green;
      }
      [data-color="orange"] {
        background-color: orange;
      }
      [data-color="purple"] {
        background-color: purple;
      }
      [data-color="violet"] {
        background-color: violet;
      }
      .color-box.selected {
        border: 5px solid black;
        margin: 0;
      }

      .blue {
        color: blue;
      }
      input.blue {
        border: 2px solid blue;
      }
      .violet {
        color: violet;
      }
      input.violet {
        border: 2px solid violet;
      }
      .purple {
        color: purple;
      }
      input.purple {
        border: 2px solid purple;
      }
      .red {
        color: red;
      }
      input.red {
        border: 2px solid red;
      }
      .green {
        color: green;
      }
      input.green {
        border: 2px solid green;
      }
      .orange {
        color: orange;
      }
      input.orange {
        border: 2px solid orange;
      }
      .row {
        display: flex;
      }
    </style>
  </head>
  <body>
    <div class="center-content">
      <div>
        <div>
          <span class="color-box selected" data-color="red"></span>
          <span class="color-box" data-color="blue"></span>
          <span class="color-box" data-color="green"></span>
          <span class="color-box" data-color="orange"></span>
          <span class="color-box" data-color="violet"></span>
          <span class="color-box" data-color="purple"></span>
        </div>
        <div class="row">
          <input type="text" id="text" class="red" autocapitalize="characters" />
          <button id="speak" disabled>üëÑ</button>
          <button id="save" disabled>‚§µÔ∏è</button>
        </div>
        <div id="saved"></div>
      </div>
    </div>
    <script>
      window.addEventListener("DOMContentLoaded", () => {
        var synth = window.speechSynthesis;
        let btnSpeak = document.querySelector("#speak");
        let btnSave = document.querySelector("#save");
        let txt = document.querySelector("#text");
        let saved = document.querySelector("#saved");
        let words = [];

        document.body.addEventListener("click", (event) => {
          changeColor(event.target);
        });
        document.body.addEventListener("touchstart", (event) => {
          changeColor(event.target);
        });

        var changeColor = (target) => {
          if (event.target.parentElement.id) {
            say(event.target.textContent);
          }
          if (event.target.classList.contains("color-box")) {
            document.querySelectorAll(".color-box").forEach((item) => {
              item.classList.remove("selected");
            });
            event.target.classList.add("selected");
            txt.classList = [];
            txt.classList.add(event.target.getAttribute("data-color"));
          }
          txt.focus();
        };

        txt.addEventListener("keydown", (e) => {
          if (e.code === "ArrowDown") {
            save();
          }
          if (e.code === "Enter") {
            say(txt.value);
          }
        });

        txt.addEventListener("beforeinput", (e) => {
          if (e.data != null) {
            say(e.data);
          }
        });

        txt.addEventListener("input", (e) => {
          if (txt.value) {
            btnSave.disabled = false;
            btnSpeak.disabled = false;
          } else {
            btnSave.disabled = true;
            btnSpeak.disabled = true;
          }
        });

        document.querySelector(".color-box.red", () => {});

        btnSave.addEventListener("click", () => {
          save();
          txt.focus();
        });
        btnSpeak.addEventListener("click", () => {
          say(txt.value);
          txt.focus();
        });

        var save = () => {
          words.push({
            color: document.querySelector(".selected").getAttribute("data-color"),
            text: txt.value,
          });
          saved.innerHTML = "";
          words.forEach((word) => {
            saved.innerHTML = "<div class=" + word.color + ">" + word.text + "</div>" + saved.innerHTML;
          });
          txt.value = "";
        };

        var say = (text) => {
          let u = new SpeechSynthesisUtterance();
          u.voice = window.speechSynthesis.getVoices().find((v) => v.voiceURI === "Alva");
          // u.lang = "sv-SE";
          u.text = text.toLowerCase();
          speechSynthesis.cancel();
          speechSynthesis.speak(u);
        };
      });
    </script>
  </body>
</html>
